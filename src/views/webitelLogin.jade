doctype html
html
   head
      title Login
      meta(name='viewport', content='width=device-width, initial-scale=1.0')

      style.
         @import url(http://weloveiconfonts.com/api/?family=fontawesome);
         @import url(http://fonts.googleapis.com/css?family=Open+Sans:400,700);
         [class*="fontawesome-"]:before {
            font-family: 'FontAwesome', sans-serif;
         }
         * {
            box-sizing: border-box;
         }
         html {
            height: 100%;
         }
         body {
            background-color: #111111;
            color: #606468;
            font: 400 0.875rem/1.5 "Open Sans", sans-serif;
            margin: 0;
            min-height: 100%;
         }
         a {
            color: #eee;
            outline: 0;
            text-decoration: none;
         }
         a:focus, a:hover {
            text-decoration: underline;
         }
         input {
            border: 0;
            color: inherit;
            font: inherit;
            margin: 0;
            outline: 0;
            padding: 0;
            -webkit-transition: background-color .3s;
            transition: background-color .3s;
         }
         .site__container {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            padding: 3rem 0;
         }
         .form input[type="password"], .form input[type="text"], .form input[type="submit"] {
            width: 100%;
         }
         .form--login {
            color: #f7fff6;
         }
         .form--login label,
         .form--login input[type="text"],
         .form--login input[type="password"],
         .form--login input[type="submit"] {
            border-radius: 0.25rem;
            padding: 1rem;
         }
         .form--login label {
            background-color: #363b41;
            border-bottom-right-radius: 0;
            border-top-right-radius: 0;
            padding-left: 1.25rem;
            padding-right: 1.25rem;
         }
         .form--login input[type="text"], .form--login input[type="password"] {
            background-color: #3b4148;
            border-bottom-left-radius: 0;
            border-top-left-radius: 0;
         }
         .form--login input[type="text"]:focus, .form--login input[type="text"]:hover, .form--login input[type="password"]:focus, .form--login input[type="password"]:hover {
            background-color: #434A52;
         }
         .form--login input[type="submit"] {
            background-color: #229807;
            color: #EEEEEE;
            font-weight: bold;
            text-transform: uppercase;
         }
         .form--login input[type="submit"]:focus, .form--login input[type="submit"]:hover {
            background-color: #0bea10;
         }
         .form__field {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            margin-bottom: 1rem;
         }
         .form__input {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
         }
         .align {
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: horizontal;
            -webkit-box-direction: normal;
            -webkit-flex-direction: row;
            -ms-flex-direction: row;
            flex-direction: row;
         }
         .hidden {
            border: 0;
            clip: rect(0 0 0 0);
            height: 1px;
            margin: -1px;
            overflow: hidden;
            padding: 0;
            position: absolute;
            width: 1px;
         }
         .text--center {
            text-align: center;
         }
         .grid__container {
            margin: 0 auto;
            max-width: 20rem;
            width: 90%;
         }
         .error {
            border: 1px solid;
            margin: 10px 0px;
            padding: 15px 10px 15px 50px;
            background-repeat: no-repeat;
            background-position: 10px center;
            color: #D8000C;
            background-color: #FFBABA;
         }

body
   body.align
      div.site__container
         div.grid__container
            //div.form__field(style="height: 51px;")
               img(src="/images/no_border.png", style="height: 51px;")
            h1 Kibana

            form.form.form--login(name="loginForm", style="position:relative;")
               div.form__field
                  label.fontawesome-user(for="login__username")
                     span.hidden Username
                  input#login__username.form__input(placeholder="Username", type="text", required)
               div.form__field
                  label.fontawesome-lock(for="login__password")
                     span.hidden Username
                  input#login__password.form__input(placeholder="Password", type="password")
               div.form__field
                  //button(type="submit", onclick="submitform()") Sign In
                  input(type="submit", value="Sign In", onclick="submitform(); return false;")
               div#errorMsg.error(style="position:absolute;width:100%;display:none") Error


script(type='text/javascript').
   var timerId;
   function getXmlHttp() {
      var xmlhttp;
      try {
         xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
      } catch (e) {
         try {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
         } catch (E) {
            xmlhttp = false;
         }
      }
      if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
         xmlhttp = new XMLHttpRequest();
      }
      return xmlhttp;
   };

   function submitform() {
      var xhr = getXmlHttp();
      xhr.open("post", "/login", true);
      xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
      var j = {
         "username": document.getElementById('login__username').value,
         "password": document.getElementById('login__password').value
      };
      xhr.onreadystatechange = function () {
         if (xhr.readyState == 4) {
            if (xhr.status == 200) {
               window.location.pathname = '/';
            } else {
               var err = document.getElementById('errorMsg');
               err.style.display = '';
               err.innerHTML = 'Invalid Username or Password (' + xhr.status + ')';
               if (timerId)
                  clearTimeout(timerId);
               timerId = setTimeout(function () {
                  err.style.display = 'none';
               }, 5000);
            };
         };
      };
      xhr.send(JSON.stringify(j));
   };